<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2026-01-09T00:28:17+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">A Dev Writes</title><subtitle>Technical articles on software engineering, observability, and distributed systems</subtitle><author><name>Laxman Sharma</name></author><entry><title type="html">Welcome to A Dev Writes</title><link href="http://localhost:4000/2026/01/14/welcome/" rel="alternate" type="text/html" title="Welcome to A Dev Writes" /><published>2026-01-14T00:00:00+08:00</published><updated>2026-01-14T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/14/welcome</id><content type="html" xml:base="http://localhost:4000/2026/01/14/welcome/"><![CDATA[<h1 id="hello-world-">Hello, World! ğŸ‘‹</h1>

<p>Welcome to <strong>A Dev Writes</strong>. Iâ€™m Laxman Sharma, and this is my corner of the internet dedicated to the craft of software engineering.</p>

<h2 id="why-this-blog">Why This Blog?</h2>

<p>In our fast-paced industry, we often copy-paste solutions without deeply understanding them. My goal here is different: <strong>to slow down and dissect the â€œwhyâ€ and â€œhowâ€ of complex systems.</strong></p>

<h2 id="what-you-can-expect">What You Can Expect</h2>

<p>I write about the problems Iâ€™ve faced in production and the patterns Iâ€™ve learned to solve them. Key topics include:</p>

<ul>
  <li><strong>Distributed Systems</strong>: Microservices patterns, consistency models, and resilience.</li>
  <li><strong>Observability</strong>: Going beyond logs to true system visibility (check out my <a href="/tags/#opentelemetry">OpenTelemetry series</a>).</li>
  <li><strong>Engineering Culture</strong>: Building high-performing teams and pragmatic processes.</li>
  <li><strong>Java &amp; Spring</strong>: Deep dives into the ecosystem I work with daily.</li>
</ul>

<h2 id="join-the-conversation">Join the Conversation</h2>

<p>This isnâ€™t just a broadcast channel. I want to learn from you too. Connect with me on <a href="https://www.linkedin.com/in/laxman-sharma-328b2659">LinkedIn</a>, <a href="https://github.com/laxman-sharma">GitHub</a>, or check out my profile on <a href="https://www.toptal.com/resume/laxman-sharma">Toptal</a>.</p>

<p>Detailed, technical, and practical. Thatâ€™s the promise.</p>

<p>Grab a coffee â˜• and letâ€™s build something great.</p>

<hr />
<p><em>P.S. To get started, check out my deep dive into <a href="/2026/01/08/opentelemetry-java-part-1-fundamentals/">OpenTelemetry Fundamentals</a>.</em></p>]]></content><author><name>Laxman Sharma</name></author><category term="introduction" /><category term="community" /><category term="welcome" /><category term="engineering" /><category term="distributed-systems" /><category term="observability" /><summary type="html"><![CDATA[Hi, I'm Laxman. Welcome to my digital garden where I share deep dives into distributed systems, observability, and software engineering patterns.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/welcome-hero.png" /><media:content medium="image" url="http://localhost:4000/assets/images/welcome-hero.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">OpenTelemetry with Java: Part 6 - Production Patterns &amp;amp; The Collector</title><link href="http://localhost:4000/2026/01/13/opentelemetry-java-part-6-production/" rel="alternate" type="text/html" title="OpenTelemetry with Java: Part 6 - Production Patterns &amp;amp; The Collector" /><published>2026-01-13T00:00:00+08:00</published><updated>2026-01-13T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/13/opentelemetry-java-part-6-production</id><content type="html" xml:base="http://localhost:4000/2026/01/13/opentelemetry-java-part-6-production/"><![CDATA[<h1 id="production-patterns--the-collector">Production Patterns &amp; The Collector</h1>

<p><em>Part 6 of a 6-part series on implementing observability in Java microservices</em></p>

<hr />

<p>Weâ€™ve built traces, metrics, and logs. But sending telemetry directly from applications to backends doesnâ€™t scale.</p>

<p>Enter the <strong>OpenTelemetry Collector</strong>â€”the central nervous system of your observability pipeline.</p>

<h2 id="why-you-need-the-collector">Why You Need the Collector</h2>

<p>Direct export from apps:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>App 1 â†’ Jaeger
App 2 â†’ Jaeger
App 3 â†’ Jaeger
</code></pre></div></div>

<p>Problems:</p>
<ul>
  <li>Every app needs backend credentials</li>
  <li>Canâ€™t change backends without app redeployment</li>
  <li>No centralized sampling or filtering</li>
  <li>Apps impacted by backend downtime</li>
</ul>

<p>With the Collector:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>App 1 â”€â”
App 2 â”€â”¼â†’ Collector â†’ Jaeger
App 3 â”€â”˜             â†’ Prometheus
                     â†’ Datadog
</code></pre></div></div>

<p>Benefits:</p>
<ul>
  <li>Single configuration point</li>
  <li>Apps are insulated from backend changes</li>
  <li>Centralized sampling and transformation</li>
  <li>Buffering during backend outages</li>
</ul>

<h2 id="collector-architecture">Collector Architecture</h2>

<p>The Collector has three main components:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  OTel Collector                       â”‚
â”‚                                                       â”‚
â”‚  Receivers    â†’    Processors    â†’    Exporters      â”‚
â”‚  (OTLP, Jaeger)    (batch, filter)   (OTLP, Prom)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div>

<ul>
  <li><strong>Receivers</strong>: Ingest telemetry (OTLP, Jaeger, Zipkin, Kafka)</li>
  <li><strong>Processors</strong>: Transform, filter, batch, sample</li>
  <li><strong>Exporters</strong>: Send to backends (Jaeger, Prometheus, vendors)</li>
</ul>

<h2 id="basic-collector-configuration">Basic Collector Configuration</h2>

<p>Create <code class="language-plaintext highlighter-rouge">otel-collector-config.yaml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">receivers</span><span class="pi">:</span>
  <span class="na">otlp</span><span class="pi">:</span>
    <span class="na">protocols</span><span class="pi">:</span>
      <span class="na">grpc</span><span class="pi">:</span>
        <span class="na">endpoint</span><span class="pi">:</span> <span class="s">0.0.0.0:4317</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">endpoint</span><span class="pi">:</span> <span class="s">0.0.0.0:4318</span>

<span class="na">processors</span><span class="pi">:</span>
  <span class="na">batch</span><span class="pi">:</span>
    <span class="na">timeout</span><span class="pi">:</span> <span class="s">5s</span>
    <span class="na">send_batch_size</span><span class="pi">:</span> <span class="m">1000</span>
  
  <span class="na">resource</span><span class="pi">:</span>
    <span class="na">attributes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">environment</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s">production</span>
        <span class="na">action</span><span class="pi">:</span> <span class="s">insert</span>

<span class="na">exporters</span><span class="pi">:</span>
  <span class="na">otlp/jaeger</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">jaeger:4317</span>
    <span class="na">tls</span><span class="pi">:</span>
      <span class="na">insecure</span><span class="pi">:</span> <span class="kc">true</span>
  
  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">0.0.0.0:8889</span>
  
  <span class="na">logging</span><span class="pi">:</span>
    <span class="na">verbosity</span><span class="pi">:</span> <span class="s">detailed</span>

<span class="na">service</span><span class="pi">:</span>
  <span class="na">pipelines</span><span class="pi">:</span>
    <span class="na">traces</span><span class="pi">:</span>
      <span class="na">receivers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp</span><span class="pi">]</span>
      <span class="na">processors</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">batch</span><span class="pi">,</span> <span class="nv">resource</span><span class="pi">]</span>
      <span class="na">exporters</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp/jaeger</span><span class="pi">,</span> <span class="nv">logging</span><span class="pi">]</span>
    
    <span class="na">metrics</span><span class="pi">:</span>
      <span class="na">receivers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp</span><span class="pi">]</span>
      <span class="na">processors</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">batch</span><span class="pi">,</span> <span class="nv">resource</span><span class="pi">]</span>
      <span class="na">exporters</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">prometheus</span><span class="pi">]</span>
    
    <span class="na">logs</span><span class="pi">:</span>
      <span class="na">receivers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp</span><span class="pi">]</span>
      <span class="na">processors</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">batch</span><span class="pi">]</span>
      <span class="na">exporters</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">logging</span><span class="pi">]</span>
</code></pre></div></div>

<h2 id="docker-compose-with-collector">Docker Compose with Collector</h2>

<p>Complete stack:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">otel-collector</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">otel/opentelemetry-collector-contrib:0.91.0</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">otel-collector</span>
    <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">--config=/etc/otel-collector-config.yaml"</span><span class="pi">]</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./otel-collector-config.yaml:/etc/otel-collector-config.yaml</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">4317:4317"</span>   <span class="c1"># OTLP gRPC</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">4318:4318"</span>   <span class="c1"># OTLP HTTP</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8889:8889"</span>   <span class="c1"># Prometheus metrics</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">jaeger</span>

  <span class="na">jaeger</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">jaegertracing/all-in-one:1.53</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">16686:16686"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">COLLECTOR_OTLP_ENABLED=true</span>

  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/prometheus:v2.48.0</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">9090:9090"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./prometheus.yml:/etc/prometheus/prometheus.yml</span>

  <span class="na">grafana</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">grafana/grafana:10.2.0</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">3000:3000"</span>
</code></pre></div></div>

<p>Now point your apps to the collector:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="se">\</span>
  <span class="nt">-Dotel</span>.service.name<span class="o">=</span>order-service <span class="se">\</span>
  <span class="nt">-Dotel</span>.exporter.otlp.endpoint<span class="o">=</span>http://localhost:4317 <span class="se">\</span>
  <span class="nt">-jar</span> order-service.jar
</code></pre></div></div>

<h2 id="sampling-strategies">Sampling Strategies</h2>

<p>In production, you canâ€™t keep 100% of traces. Sampling reduces costs while preserving visibility.</p>

<h3 id="head-based-sampling">Head-Based Sampling</h3>

<p>Decide at trace start whether to sample:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">processors</span><span class="pi">:</span>
  <span class="na">probabilistic_sampler</span><span class="pi">:</span>
    <span class="na">sampling_percentage</span><span class="pi">:</span> <span class="m">10</span>  <span class="c1"># Keep 10% of traces</span>
</code></pre></div></div>

<p><strong>Pros</strong>: Simple, low overhead<br />
<strong>Cons</strong>: Might miss interesting traces</p>

<h3 id="tail-based-sampling">Tail-Based Sampling</h3>

<p>Decide after seeing the complete trace:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">processors</span><span class="pi">:</span>
  <span class="na">tail_sampling</span><span class="pi">:</span>
    <span class="na">decision_wait</span><span class="pi">:</span> <span class="s">10s</span>
    <span class="na">policies</span><span class="pi">:</span>
      <span class="c1"># Always keep errors</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">errors</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">status_code</span>
        <span class="na">status_code</span><span class="pi">:</span>
          <span class="na">status_codes</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">ERROR</span><span class="pi">]</span>
      
      <span class="c1"># Always keep slow requests</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">slow-requests</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">latency</span>
        <span class="na">latency</span><span class="pi">:</span>
          <span class="na">threshold_ms</span><span class="pi">:</span> <span class="m">1000</span>
      
      <span class="c1"># Sample 10% of everything else</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">probabilistic</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">probabilistic</span>
        <span class="na">probabilistic</span><span class="pi">:</span>
          <span class="na">sampling_percentage</span><span class="pi">:</span> <span class="m">10</span>
</code></pre></div></div>

<p><strong>Pros</strong>: Keeps interesting traces<br />
<strong>Cons</strong>: Requires memory, more complex</p>

<h3 id="recommended-strategy">Recommended Strategy</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">policies</span><span class="pi">:</span>
  <span class="c1"># Keep all errors (critical for debugging)</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">errors</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">status_code</span>
    <span class="na">status_code</span><span class="pi">:</span>
      <span class="na">status_codes</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">ERROR</span><span class="pi">]</span>
  
  <span class="c1"># Keep slow requests (99th percentile+)</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">high-latency</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">latency</span>
    <span class="na">latency</span><span class="pi">:</span>
      <span class="na">threshold_ms</span><span class="pi">:</span> <span class="m">2000</span>
  
  <span class="c1"># Sample 5% of successful fast requests</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">baseline</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">probabilistic</span>
    <span class="na">probabilistic</span><span class="pi">:</span>
      <span class="na">sampling_percentage</span><span class="pi">:</span> <span class="m">5</span>
</code></pre></div></div>

<h2 id="multi-backend-export">Multi-Backend Export</h2>

<p>Send to multiple destinations:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">exporters</span><span class="pi">:</span>
  <span class="c1"># Open source backends</span>
  <span class="na">otlp/jaeger</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">jaeger:4317</span>
  
  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">0.0.0.0:8889</span>
  
  <span class="c1"># Vendor backend</span>
  <span class="na">otlp/datadog</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">https://otel.datadoghq.com:4317</span>
    <span class="na">headers</span><span class="pi">:</span>
      <span class="na">DD-API-KEY</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DD_API_KEY}"</span>

<span class="na">service</span><span class="pi">:</span>
  <span class="na">pipelines</span><span class="pi">:</span>
    <span class="na">traces</span><span class="pi">:</span>
      <span class="na">receivers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp</span><span class="pi">]</span>
      <span class="na">processors</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">batch</span><span class="pi">]</span>
      <span class="na">exporters</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp/jaeger</span><span class="pi">,</span> <span class="nv">otlp/datadog</span><span class="pi">]</span>
</code></pre></div></div>

<h2 id="kubernetes-deployment-patterns">Kubernetes Deployment Patterns</h2>

<h3 id="sidecar-pattern">Sidecar Pattern</h3>

<p>One collector per pod:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">order-service:latest</span>
          <span class="na">env</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">OTEL_EXPORTER_OTLP_ENDPOINT</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://localhost:4317"</span>
        
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">otel-collector</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">otel/opentelemetry-collector:0.91.0</span>
          <span class="na">ports</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">4317</span>
</code></pre></div></div>

<p><strong>Pros</strong>: Isolation, per-app config<br />
<strong>Cons</strong>: Resource overhead</p>

<h3 id="daemonset-pattern">DaemonSet Pattern</h3>

<p>One collector per node:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">DaemonSet</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">otel-collector</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">otel-collector</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">otel-collector</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">otel/opentelemetry-collector:0.91.0</span>
          <span class="na">ports</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">4317</span>
              <span class="na">hostPort</span><span class="pi">:</span> <span class="m">4317</span>
</code></pre></div></div>

<p><strong>Pros</strong>: Lower resource usage<br />
<strong>Cons</strong>: Shared config, noisy neighbor risk</p>

<h3 id="gateway-pattern">Gateway Pattern</h3>

<p>Central collector deployment:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">otel-collector-gateway</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">otel-collector</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">otel/opentelemetry-collector:0.91.0</span>
</code></pre></div></div>

<p><strong>Pros</strong>: Centralized, easy to manage<br />
<strong>Cons</strong>: Single point of failure (mitigate with HA)</p>

<h2 id="resource-attributes">Resource Attributes</h2>

<p>Enrich all telemetry with context:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">processors</span><span class="pi">:</span>
  <span class="na">resource</span><span class="pi">:</span>
    <span class="na">attributes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">deployment.environment</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s">production</span>
        <span class="na">action</span><span class="pi">:</span> <span class="s">insert</span>
      <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">service.namespace</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s">ecommerce</span>
        <span class="na">action</span><span class="pi">:</span> <span class="s">insert</span>
      <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">k8s.cluster.name</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s">prod-us-east-1</span>
        <span class="na">action</span><span class="pi">:</span> <span class="s">insert</span>
</code></pre></div></div>

<p>Or use the resource detection processor:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">processors</span><span class="pi">:</span>
  <span class="na">resourcedetection</span><span class="pi">:</span>
    <span class="na">detectors</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">env</span><span class="pi">,</span> <span class="nv">system</span><span class="pi">,</span> <span class="nv">docker</span><span class="pi">,</span> <span class="nv">gcp</span><span class="pi">,</span> <span class="nv">aws</span><span class="pi">,</span> <span class="nv">azure</span><span class="pi">]</span>
</code></pre></div></div>

<h2 id="common-pitfalls">Common Pitfalls</h2>

<h3 id="1-missing-tls-in-production">1. Missing TLS in Production</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Bad - insecure in production</span>
<span class="na">exporters</span><span class="pi">:</span>
  <span class="na">otlp</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">collector:4317</span>
    <span class="na">tls</span><span class="pi">:</span>
      <span class="na">insecure</span><span class="pi">:</span> <span class="kc">true</span>

<span class="c1"># Good - proper TLS</span>
<span class="na">exporters</span><span class="pi">:</span>
  <span class="na">otlp</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">collector:4317</span>
    <span class="na">tls</span><span class="pi">:</span>
      <span class="na">cert_file</span><span class="pi">:</span> <span class="s">/certs/client.crt</span>
      <span class="na">key_file</span><span class="pi">:</span> <span class="s">/certs/client.key</span>
</code></pre></div></div>

<h3 id="2-no-memory-limits">2. No Memory Limits</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Add memory limiting</span>
<span class="na">processors</span><span class="pi">:</span>
  <span class="na">memory_limiter</span><span class="pi">:</span>
    <span class="na">check_interval</span><span class="pi">:</span> <span class="s">1s</span>
    <span class="na">limit_mib</span><span class="pi">:</span> <span class="m">512</span>
    <span class="na">spike_limit_mib</span><span class="pi">:</span> <span class="m">128</span>
</code></pre></div></div>

<h3 id="3-no-retry-on-failure">3. No Retry on Failure</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">exporters</span><span class="pi">:</span>
  <span class="na">otlp</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">backend:4317</span>
    <span class="na">retry_on_failure</span><span class="pi">:</span>
      <span class="na">enabled</span><span class="pi">:</span> <span class="kc">true</span>
      <span class="na">initial_interval</span><span class="pi">:</span> <span class="s">5s</span>
      <span class="na">max_interval</span><span class="pi">:</span> <span class="s">30s</span>
</code></pre></div></div>

<h2 id="final-architecture">Final Architecture</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Kubernetes Cluster                          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚ Order    â”‚ â”‚Inventory â”‚ â”‚ Payment  â”‚  Applications           â”‚
â”‚  â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚  (with OTel Agent)      â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚       â”‚            â”‚            â”‚                               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                    â”‚ OTLP                                       â”‚
â”‚                    â–¼                                            â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚            â”‚    OTel      â”‚  Collector                          â”‚
â”‚            â”‚  Collector   â”‚  (sampling, batching, routing)      â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                   â”‚                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚     â–¼             â–¼             â–¼                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚ â”‚ Jaeger â”‚  â”‚Prometheusâ”‚  â”‚ Grafana â”‚  Backends                â”‚
â”‚ â”‚(traces)â”‚  â”‚(metrics) â”‚  â”‚ (viz)   â”‚                         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div>

<h2 id="series-recap">Series Recap</h2>

<p>Weâ€™ve covered the complete journey:</p>

<ol>
  <li><strong>Fundamentals</strong>: Traces, metrics, logs, OTel architecture</li>
  <li><strong>Auto-Instrumentation</strong>: Zero-code tracing with Java Agent</li>
  <li><strong>Custom Instrumentation</strong>: Business context with spans &amp; attributes</li>
  <li><strong>Metrics</strong>: Counters, gauges, histograms, Grafana dashboards</li>
  <li><strong>Logs</strong>: Trace correlation, structured logging</li>
  <li><strong>Production</strong>: Collector, sampling, Kubernetes patterns</li>
</ol>

<p>You now have everything needed to implement production-grade observability in your Java microservices.</p>

<hr />

<p><em>Previous: <a href="/2026/01/12/opentelemetry-java-part-5-logs/">Part 5 - Logs in Context</a></em></p>

<hr />

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://opentelemetry.io/docs/collector/">OTel Collector Docs</a></li>
  <li><a href="https://opentelemetry.io/docs/collector/configuration/">Collector Configuration</a></li>
  <li><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/tailsamplingprocessor">Tail Sampling Processor</a></li>
  <li><a href="https://github.com/open-telemetry/opentelemetry-operator">Kubernetes Operator</a></li>
</ul>]]></content><author><name>Laxman Sharma</name></author><category term="observability" /><category term="java" /><category term="opentelemetry" /><category term="collector" /><category term="sampling" /><category term="kubernetes" /><category term="production" /><summary type="html"><![CDATA[Production-ready observability with the OpenTelemetry Collector. Learn about sampling strategies, multi-backend export, and Kubernetes deployment patterns.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/otel-part6-hero.png" /><media:content medium="image" url="http://localhost:4000/assets/images/otel-part6-hero.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">OpenTelemetry with Java: Part 5 - Logs in Context</title><link href="http://localhost:4000/2026/01/12/opentelemetry-java-part-5-logs/" rel="alternate" type="text/html" title="OpenTelemetry with Java: Part 5 - Logs in Context" /><published>2026-01-12T00:00:00+08:00</published><updated>2026-01-12T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/12/opentelemetry-java-part-5-logs</id><content type="html" xml:base="http://localhost:4000/2026/01/12/opentelemetry-java-part-5-logs/"><![CDATA[<h1 id="logs-in-context">Logs in Context</h1>

<p><em>Part 5 of a 6-part series on implementing observability in Java microservices</em></p>

<hr />

<p>You have traces showing request flow and metrics showing system health. But when something goes wrong, you still <code class="language-plaintext highlighter-rouge">grep</code> through logs. Wouldnâ€™t it be nice if those logs were automatically connected to traces?</p>

<p>Thatâ€™s what weâ€™re building today.</p>

<h2 id="the-problem-disconnected-logs">The Problem: Disconnected Logs</h2>

<p>Traditional logging:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2026-01-12 10:15:30 [order-service] ERROR Payment failed for order
2026-01-12 10:15:30 [payment-service] ERROR Insufficient funds
</code></pre></div></div>

<p>Questions this doesnâ€™t answer:</p>
<ul>
  <li>Were these for the same request?</li>
  <li>What was the full request flow?</li>
  <li>What else happened in this transaction?</li>
</ul>

<h2 id="the-solution-trace-correlated-logs">The Solution: Trace-Correlated Logs</h2>

<p>With OpenTelemetry context:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2026-01-12 10:15:30 [order-service] traceId=abc123 spanId=def456 ERROR Payment failed for order
2026-01-12 10:15:30 [payment-service] traceId=abc123 spanId=ghi789 ERROR Insufficient funds
</code></pre></div></div>

<p>Now you can:</p>
<ul>
  <li>Filter all logs for a single trace</li>
  <li>Jump from a trace to its logs</li>
  <li>See the complete picture</li>
</ul>

<h2 id="how-it-works">How It Works</h2>

<p>The OTel Java Agent automatically puts trace context into the MDC (Mapped Diagnostic Context). Your logging framework reads from MDC.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Your Application                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         OTel Java Agent                  â”‚    â”‚
â”‚  â”‚    (populates MDC with trace context)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                       â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Logback / Log4j2                      â”‚    â”‚
â”‚  â”‚    (reads trace_id, span_id from MDC)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div>

<h2 id="configuration-logback">Configuration: Logback</h2>

<p>Create or update <code class="language-plaintext highlighter-rouge">src/main/resources/logback-spring.xml</code>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    
    <span class="c">&lt;!-- Console output with trace context --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"CONSOLE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>
                %d{ISO8601} [%thread] %-5level %logger{36} - traceId=%X{trace_id} spanId=%X{span_id} - %msg%n
            <span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>

    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"CONSOLE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
    
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<p>Now every log line includes trace context:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2026-01-12T10:15:30.123 [main] INFO  c.e.OrderService - traceId=a1b2c3d4e5f6 spanId=1a2b3c4d - Processing order
</code></pre></div></div>

<h2 id="json-structured-logging">JSON Structured Logging</h2>

<p>For log aggregation systems (ELK, Loki, Datadog), use JSON:</p>

<h3 id="add-logstash-encoder">Add Logstash Encoder</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>net.logstash.logback<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>logstash-logback-encoder<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>7.4<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h3 id="configure-json-output">Configure JSON Output</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"JSON"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder</span> <span class="na">class=</span><span class="s">"net.logstash.logback.encoder.LogstashEncoder"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;includeMdcKeyName&gt;</span>trace_id<span class="nt">&lt;/includeMdcKeyName&gt;</span>
            <span class="nt">&lt;includeMdcKeyName&gt;</span>span_id<span class="nt">&lt;/includeMdcKeyName&gt;</span>
            <span class="nt">&lt;includeMdcKeyName&gt;</span>trace_flags<span class="nt">&lt;/includeMdcKeyName&gt;</span>
            
            <span class="nt">&lt;customFields&gt;</span>{"service":"order-service"}<span class="nt">&lt;/customFields&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>

    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"JSON"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
    
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"@timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2026-01-12T10:15:30.123Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INFO"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"logger_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.example.OrderService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Processing order"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"trace_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a1b2c3d4e5f67890a1b2c3d4e5f67890"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"span_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1a2b3c4d5e6f7890"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"order-service"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="configuration-log4j2">Configuration: Log4j2</h2>

<p>If you use Log4j2, hereâ€™s the equivalent:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;Configuration&gt;</span>
    <span class="nt">&lt;Appenders&gt;</span>
        <span class="nt">&lt;Console</span> <span class="na">name=</span><span class="s">"Console"</span> <span class="na">target=</span><span class="s">"SYSTEM_OUT"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">"%d{ISO8601} [%t] %-5level %logger{36} - traceId=%X{trace_id} spanId=%X{span_id} - %msg%n"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Console&gt;</span>
    <span class="nt">&lt;/Appenders&gt;</span>
    
    <span class="nt">&lt;Loggers&gt;</span>
        <span class="nt">&lt;Root</span> <span class="na">level=</span><span class="s">"info"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"Console"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Root&gt;</span>
    <span class="nt">&lt;/Loggers&gt;</span>
<span class="nt">&lt;/Configuration&gt;</span>
</code></pre></div></div>

<h2 id="adding-context-to-logs-programmatically">Adding Context to Logs Programmatically</h2>

<p>Add business context alongside trace context:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.MDC</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="nc">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">OrderService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">createOrder</span><span class="o">(</span><span class="nc">OrderRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Add business context to MDC</span>
        <span class="no">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">,</span> <span class="n">request</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">());</span>
        <span class="no">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customer.id"</span><span class="o">,</span> <span class="n">request</span><span class="o">.</span><span class="na">getCustomerId</span><span class="o">());</span>
        
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Starting order processing"</span><span class="o">);</span>
            
            <span class="n">validateOrder</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Order validated"</span><span class="o">);</span>
            
            <span class="n">processPayment</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Payment processed"</span><span class="o">);</span>
            
            <span class="k">return</span> <span class="nf">saveOrder</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Order processing failed"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
            
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="c1">// Clean up MDC</span>
            <span class="no">MDC</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">);</span>
            <span class="no">MDC</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">"customer.id"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Output includes both trace and business context:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Payment processed"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"trace_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a1b2c3d4e5f67890"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"span_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1a2b3c4d5e6f7890"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"order.id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ORD-12345"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"customer.id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CUST-67890"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="viewing-logs-with-traces">Viewing Logs with Traces</h2>

<h3 id="in-jaeger">In Jaeger</h3>

<p>Jaeger 1.35+ supports logs. Configure your collector to receive logs:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">receivers</span><span class="pi">:</span>
  <span class="na">otlp</span><span class="pi">:</span>
    <span class="na">protocols</span><span class="pi">:</span>
      <span class="na">grpc</span><span class="pi">:</span>

<span class="na">exporters</span><span class="pi">:</span>
  <span class="na">jaeger</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">jaeger:14250</span>

<span class="na">service</span><span class="pi">:</span>
  <span class="na">pipelines</span><span class="pi">:</span>
    <span class="na">logs</span><span class="pi">:</span>
      <span class="na">receivers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">otlp</span><span class="pi">]</span>
      <span class="na">exporters</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">jaeger</span><span class="pi">]</span>
</code></pre></div></div>

<h3 id="in-grafana-with-loki">In Grafana (with Loki)</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Add Loki to docker-compose.yml</span>
<span class="na">loki</span><span class="pi">:</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">grafana/loki:2.9.0</span>
  <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">3100:3100"</span>
</code></pre></div></div>

<p>In Grafana, you can then:</p>
<ol>
  <li>View a trace</li>
  <li>Click â€œLogs for this traceâ€</li>
  <li>See all logs with matching trace_id</li>
</ol>

<h2 id="best-practices">Best Practices</h2>

<h3 id="1-log-at-appropriate-levels">1. Log at Appropriate Levels</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Detailed processing info: {}"</span><span class="o">,</span> <span class="n">details</span><span class="o">);</span>  <span class="c1">// Dev debugging</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Order created: {}"</span><span class="o">,</span> <span class="n">orderId</span><span class="o">);</span>              <span class="c1">// Normal operations</span>
<span class="n">log</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Retry attempt {} for payment"</span><span class="o">,</span> <span class="n">attempt</span><span class="o">);</span>   <span class="c1">// Potential issues</span>
<span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Payment gateway timeout"</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>      <span class="c1">// Errors</span>
</code></pre></div></div>

<h3 id="2-use-structured-fields">2. Use Structured Fields</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Good - structured</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Order processed"</span><span class="o">,</span> <span class="n">kv</span><span class="o">(</span><span class="s">"orderId"</span><span class="o">,</span> <span class="n">orderId</span><span class="o">),</span> <span class="n">kv</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="n">amount</span><span class="o">));</span>

<span class="c1">// Avoid - unstructured</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Order "</span> <span class="o">+</span> <span class="n">orderId</span> <span class="o">+</span> <span class="s">" processed for $"</span> <span class="o">+</span> <span class="n">amount</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="3-dont-log-sensitive-data">3. Donâ€™t Log Sensitive Data</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Bad</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"User authenticated with password: {}"</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>

<span class="c1">// Good</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"User authenticated: userId={}"</span><span class="o">,</span> <span class="n">userId</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="4-include-error-context">4. Include Error Context</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
    <span class="n">processPayment</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">PaymentException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Payment failed for order={}, amount={}"</span><span class="o">,</span> 
              <span class="n">order</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">order</span><span class="o">.</span><span class="na">getAmount</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
    <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="whats-next">Whatâ€™s Next</h2>

<p>You now have the complete observability trifecta:</p>
<ul>
  <li><strong>Traces</strong>: Request flow across services</li>
  <li><strong>Metrics</strong>: System-wide measurements</li>
  <li><strong>Logs</strong>: Detailed event records</li>
</ul>

<p>All correlated by trace ID.</p>

<p>In <strong>Part 6</strong>, weâ€™ll productionize everything with the <strong>OpenTelemetry Collector</strong>:</p>
<ul>
  <li>Centralized telemetry pipeline</li>
  <li>Sampling strategies</li>
  <li>Multi-backend export</li>
</ul>

<hr />

<p><em>Previous: <a href="/2026/01/11/opentelemetry-java-part-4-metrics/">Part 4 - Metrics That Matter</a></em></p>

<p><em>Next: <a href="/2026/01/13/opentelemetry-java-part-6-production/">Part 6 - Production Patterns</a></em></p>

<hr />

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://opentelemetry.io/docs/specs/otel/logs/">OTel Logging</a></li>
  <li><a href="https://logback.qos.ch/manual/mdc.html">Logback MDC</a></li>
  <li><a href="https://www.slf4j.org/faq.html#logging_performance">Structured Logging Best Practices</a></li>
</ul>]]></content><author><name>Laxman Sharma</name></author><category term="observability" /><category term="java" /><category term="opentelemetry" /><category term="logging" /><category term="structured-logging" /><category term="trace-correlation" /><summary type="html"><![CDATA[Unify your logs with traces. Learn to add trace IDs to log output, configure structured JSON logging, and correlate logs with distributed traces.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/otel-part5-hero.png" /><media:content medium="image" url="http://localhost:4000/assets/images/otel-part5-hero.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">OpenTelemetry with Java: Part 4 - Metrics That Matter</title><link href="http://localhost:4000/2026/01/11/opentelemetry-java-part-4-metrics/" rel="alternate" type="text/html" title="OpenTelemetry with Java: Part 4 - Metrics That Matter" /><published>2026-01-11T00:00:00+08:00</published><updated>2026-01-11T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/11/opentelemetry-java-part-4-metrics</id><content type="html" xml:base="http://localhost:4000/2026/01/11/opentelemetry-java-part-4-metrics/"><![CDATA[<h1 id="metrics-that-matter">Metrics That Matter</h1>

<p><em>Part 4 of a 6-part series on implementing observability in Java microservices</em></p>

<hr />

<p>Traces tell you <strong>what happened</strong> to a single request. Metrics tell you <strong>whatâ€™s happening</strong> across all requests. Together, they give you complete observability.</p>

<p>In this article, weâ€™ll add custom metrics to our microservices using OpenTelemetry, export them to Prometheus, and visualize them in Grafana.</p>

<h2 id="understanding-metric-types">Understanding Metric Types</h2>

<p>OpenTelemetry supports three primary metric instruments:</p>

<h3 id="1-counter">1. Counter</h3>

<p>Counters only go up. Perfect for counting events.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Examples: request count, orders created, errors</span>
<span class="nc">LongCounter</span> <span class="n">requestCounter</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="na">counterBuilder</span><span class="o">(</span><span class="s">"http.requests"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Total HTTP requests"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">requestCounter</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="2-gauge">2. Gauge</h3>

<p>Gauges represent current values that can go up or down.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Examples: active connections, queue size, memory usage</span>
<span class="n">meter</span><span class="o">.</span><span class="na">gaugeBuilder</span><span class="o">(</span><span class="s">"connection.pool.active"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Active database connections"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">buildWithCallback</span><span class="o">(</span><span class="n">measurement</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">measurement</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="n">connectionPool</span><span class="o">.</span><span class="na">getActiveCount</span><span class="o">());</span>
    <span class="o">});</span>
</code></pre></div></div>

<h3 id="3-histogram">3. Histogram</h3>

<p>Histograms capture value distributionsâ€”essential for latency percentiles.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Examples: request duration, response size</span>
<span class="nc">DoubleHistogram</span> <span class="n">latencyHistogram</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="na">histogramBuilder</span><span class="o">(</span><span class="s">"http.request.duration"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Request latency"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setUnit</span><span class="o">(</span><span class="s">"ms"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">latencyHistogram</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="n">responseTime</span><span class="o">);</span>
</code></pre></div></div>

<h2 id="setting-up-metrics-collection">Setting Up Metrics Collection</h2>

<h3 id="add-dependencies">Add Dependencies</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.opentelemetry<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>opentelemetry-api<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.34.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h3 id="update-docker-compose">Update Docker Compose</h3>

<p>Add Prometheus and Grafana to your stack:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">jaeger</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">jaegertracing/all-in-one:1.53</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">16686:16686"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">4317:4317"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">COLLECTOR_OTLP_ENABLED=true</span>

  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/prometheus:v2.48.0</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">9090:9090"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./prometheus.yml:/etc/prometheus/prometheus.yml</span>
    <span class="na">command</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">--config.file=/etc/prometheus/prometheus.yml'</span>

  <span class="na">grafana</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">grafana/grafana:10.2.0</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">3000:3000"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">GF_SECURITY_ADMIN_PASSWORD=admin</span>
</code></pre></div></div>

<h3 id="prometheus-configuration">Prometheus Configuration</h3>

<p>Create <code class="language-plaintext highlighter-rouge">prometheus.yml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">global</span><span class="pi">:</span>
  <span class="na">scrape_interval</span><span class="pi">:</span> <span class="s">15s</span>

<span class="na">scrape_configs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">order-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">host.docker.internal:8080'</span><span class="pi">]</span>
  
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">inventory-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">host.docker.internal:8081'</span><span class="pi">]</span>
  
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">payment-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">host.docker.internal:8082'</span><span class="pi">]</span>
</code></pre></div></div>

<h3 id="enable-metrics-export">Enable Metrics Export</h3>

<p>Run your services with metrics exporter:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="se">\</span>
  <span class="nt">-Dotel</span>.service.name<span class="o">=</span>order-service <span class="se">\</span>
  <span class="nt">-Dotel</span>.metrics.exporter<span class="o">=</span>prometheus <span class="se">\</span>
  <span class="nt">-Dotel</span>.exporter.prometheus.port<span class="o">=</span>8080 <span class="se">\</span>
  <span class="nt">-jar</span> order-service.jar
</code></pre></div></div>

<h2 id="creating-custom-metrics">Creating Custom Metrics</h2>

<p>Hereâ€™s a complete example with all three metric types:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderMetrics</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Meter</span> <span class="n">meter</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">LongCounter</span> <span class="n">ordersCreated</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">LongCounter</span> <span class="n">ordersFailed</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">DoubleHistogram</span> <span class="n">orderValue</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AtomicLong</span> <span class="n">activeOrders</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AtomicLong</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    
    <span class="kd">public</span> <span class="nf">OrderMetrics</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">meter</span> <span class="o">=</span> <span class="nc">GlobalOpenTelemetry</span><span class="o">.</span><span class="na">getMeter</span><span class="o">(</span><span class="s">"order-service"</span><span class="o">);</span>
        
        <span class="c1">// Counter: Orders created</span>
        <span class="k">this</span><span class="o">.</span><span class="na">ordersCreated</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="na">counterBuilder</span><span class="o">(</span><span class="s">"orders.created"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Total orders created"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setUnit</span><span class="o">(</span><span class="s">"1"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        
        <span class="c1">// Counter: Failed orders</span>
        <span class="k">this</span><span class="o">.</span><span class="na">ordersFailed</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="na">counterBuilder</span><span class="o">(</span><span class="s">"orders.failed"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Total failed orders"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setUnit</span><span class="o">(</span><span class="s">"1"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        
        <span class="c1">// Histogram: Order values</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderValue</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="na">histogramBuilder</span><span class="o">(</span><span class="s">"orders.value"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Order value distribution"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setUnit</span><span class="o">(</span><span class="s">"USD"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        
        <span class="c1">// Gauge: Active orders in processing</span>
        <span class="n">meter</span><span class="o">.</span><span class="na">gaugeBuilder</span><span class="o">(</span><span class="s">"orders.active"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"Orders currently being processed"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildWithCallback</span><span class="o">(</span><span class="n">measurement</span> <span class="o">-&gt;</span> 
                <span class="n">measurement</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="n">activeOrders</span><span class="o">.</span><span class="na">get</span><span class="o">())</span>
            <span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">recordOrderCreated</span><span class="o">(</span><span class="nc">String</span> <span class="n">orderType</span><span class="o">,</span> <span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ordersCreated</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
            <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"order.type"</span><span class="o">),</span> <span class="n">orderType</span>
        <span class="o">));</span>
        <span class="n">orderValue</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">recordOrderFailed</span><span class="o">(</span><span class="nc">String</span> <span class="n">reason</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ordersFailed</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
            <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"failure.reason"</span><span class="o">),</span> <span class="n">reason</span>
        <span class="o">));</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">incrementActiveOrders</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">activeOrders</span><span class="o">.</span><span class="na">incrementAndGet</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">decrementActiveOrders</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">activeOrders</span><span class="o">.</span><span class="na">decrementAndGet</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="using-the-metrics">Using the Metrics</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderMetrics</span> <span class="n">metrics</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">createOrder</span><span class="o">(</span><span class="nc">OrderRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">metrics</span><span class="o">.</span><span class="na">incrementActiveOrders</span><span class="o">();</span>
        
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// Process order</span>
            <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">processOrder</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            
            <span class="n">metrics</span><span class="o">.</span><span class="na">recordOrderCreated</span><span class="o">(</span>
                <span class="n">request</span><span class="o">.</span><span class="na">getOrderType</span><span class="o">(),</span>
                <span class="n">request</span><span class="o">.</span><span class="na">getAmount</span><span class="o">().</span><span class="na">doubleValue</span><span class="o">()</span>
            <span class="o">);</span>
            
            <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
            
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">metrics</span><span class="o">.</span><span class="na">recordOrderFailed</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">());</span>
            <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
            
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">metrics</span><span class="o">.</span><span class="na">decrementActiveOrders</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="cardinality-the-silent-performance-killer">Cardinality: The Silent Performance Killer</h2>

<p><strong>Critical</strong>: High-cardinality attributes will explode your metrics storage.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// BAD - orderId has infinite cardinality</span>
<span class="n">counter</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
    <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">),</span> <span class="n">orderId</span>  <span class="c1">// Millions of unique values!</span>
<span class="o">));</span>

<span class="c1">// GOOD - orderType has low cardinality</span>
<span class="n">counter</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
    <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"order.type"</span><span class="o">),</span> <span class="n">orderType</span>  <span class="c1">// ~5 unique values</span>
<span class="o">));</span>
</code></pre></div></div>

<p><strong>Safe attributes</strong>: status codes, regions, order types, customer tiers<br />
<strong>Dangerous attributes</strong>: user IDs, order IDs, timestamps, emails</p>

<h2 id="building-a-grafana-dashboard">Building a Grafana Dashboard</h2>

<p>Access Grafana at http://localhost:3000 (admin/admin).</p>

<h3 id="add-prometheus-data-source">Add Prometheus Data Source</h3>

<ol>
  <li>Go to <strong>Configuration â†’ Data Sources</strong></li>
  <li>Add <strong>Prometheus</strong></li>
  <li>URL: <code class="language-plaintext highlighter-rouge">http://prometheus:9090</code></li>
  <li>Click <strong>Save &amp; Test</strong></li>
</ol>

<h3 id="example-dashboard-panels">Example Dashboard Panels</h3>

<p><strong>Request Rate (Counter)</strong>:</p>
<pre><code class="language-promql">rate(orders_created_total[5m])
</code></pre>

<p><strong>Error Rate (%)</strong>:</p>
<pre><code class="language-promql">rate(orders_failed_total[5m]) / rate(orders_created_total[5m]) * 100
</code></pre>

<p><strong>P95 Order Value (Histogram)</strong>:</p>
<pre><code class="language-promql">histogram_quantile(0.95, rate(orders_value_bucket[5m]))
</code></pre>

<p><strong>Active Orders (Gauge)</strong>:</p>
<pre><code class="language-promql">orders_active
</code></pre>

<h2 id="correlating-metrics-with-traces">Correlating Metrics with Traces</h2>

<p>The power comes when you connect them:</p>

<ol>
  <li><strong>Alert on metric</strong>: Error rate spikes above 5%</li>
  <li><strong>Filter traces</strong>: Find traces with errors in that timeframe</li>
  <li><strong>Debug</strong>: Examine specific failing requests</li>
</ol>

<p>With the OTel Collector (Part 6), you can automatically add <code class="language-plaintext highlighter-rouge">trace_id</code> to metrics for direct correlation.</p>

<h2 id="auto-instrumented-metrics">Auto-Instrumented Metrics</h2>

<p>The Java Agent provides these metrics out-of-the-box:</p>

<table>
  <thead>
    <tr>
      <th>Metric</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">http.server.duration</code></td>
      <td>HTTP request latency histogram</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">http.server.active_requests</code></td>
      <td>Current in-flight requests</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">db.client.connections.usage</code></td>
      <td>Database connection pool</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">jvm.memory.used</code></td>
      <td>JVM heap usage</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">jvm.gc.duration</code></td>
      <td>Garbage collection time</td>
    </tr>
  </tbody>
</table>

<h2 id="whats-next">Whatâ€™s Next</h2>

<p>You have traces enriched with business context and custom metrics for operational visibility.</p>

<p>In <strong>Part 5</strong>, weâ€™ll complete the observability story with <strong>structured logging</strong>:</p>
<ul>
  <li>Adding trace/span IDs to logs</li>
  <li>JSON logging for log aggregation</li>
  <li>Correlating logs with traces</li>
</ul>

<hr />

<p><em>Previous: <a href="/2026/01/10/opentelemetry-java-part-3-custom-instrumentation/">Part 3 - Custom Instrumentation</a></em></p>

<p><em>Next: <a href="/2026/01/12/opentelemetry-java-part-5-logs/">Part 5 - Logs in Context</a></em></p>

<hr />

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://opentelemetry.io/docs/languages/java/api/#metrics">OTel Metrics API</a></li>
  <li><a href="https://prometheus.io/docs/prometheus/latest/querying/basics/">Prometheus Querying</a></li>
  <li><a href="https://grafana.com/docs/grafana/latest/dashboards/">Grafana Dashboards</a></li>
</ul>]]></content><author><name>Laxman Sharma</name></author><category term="observability" /><category term="java" /><category term="opentelemetry" /><category term="metrics" /><category term="prometheus" /><category term="grafana" /><category term="monitoring" /><summary type="html"><![CDATA[Learn to add custom application metrics alongside traces. We'll cover counters, gauges, histograms and build a Grafana dashboard.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/otel-part4-hero.png" /><media:content medium="image" url="http://localhost:4000/assets/images/otel-part4-hero.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">OpenTelemetry with Java: Part 3 - Adding Custom Instrumentation</title><link href="http://localhost:4000/2026/01/10/opentelemetry-java-part-3-custom-instrumentation/" rel="alternate" type="text/html" title="OpenTelemetry with Java: Part 3 - Adding Custom Instrumentation" /><published>2026-01-10T00:00:00+08:00</published><updated>2026-01-10T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/10/opentelemetry-java-part-3-custom-instrumentation</id><content type="html" xml:base="http://localhost:4000/2026/01/10/opentelemetry-java-part-3-custom-instrumentation/"><![CDATA[<h1 id="adding-custom-instrumentation">Adding Custom Instrumentation</h1>

<p><em>Part 3 of a 6-part series on implementing observability in Java microservices</em></p>

<hr />

<p>In <a href="/2026/01/09/opentelemetry-java-part-2-zero-to-tracing/">Part 2</a>, we got distributed tracing working with zero code changes. But the auto-generated spans are generic: <code class="language-plaintext highlighter-rouge">POST /orders</code>, <code class="language-plaintext highlighter-rouge">GET /inventory</code>.</p>

<p>When debugging production issues, you need <strong>business context</strong>: <em>Which order failed? Which customer? What was the payment amount?</em></p>

<p>Thatâ€™s where manual instrumentation comes in.</p>

<h2 id="when-auto-instrumentation-isnt-enough">When Auto-Instrumentation Isnâ€™t Enough</h2>

<p>Auto-instrumentation is fantastic for:</p>
<ul>
  <li>HTTP requests/responses</li>
  <li>Database query timing</li>
  <li>Message queue operations</li>
</ul>

<p>But it <strong>doesnâ€™t know</strong> about your business logic:</p>
<ul>
  <li>Order IDs, customer IDs, SKUs</li>
  <li>Business validation steps</li>
  <li>Internal processing phases</li>
  <li>Custom error contexts</li>
</ul>

<h2 id="adding-the-otel-sdk-dependency">Adding the OTel SDK Dependency</h2>

<p>First, add the OpenTelemetry SDK to your project:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Maven --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.opentelemetry.instrumentation<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>opentelemetry-instrumentation-annotations<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.1.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Gradle</span>
<span class="n">implementation</span> <span class="s1">'io.opentelemetry.instrumentation:opentelemetry-instrumentation-annotations:2.1.0'</span>
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong>: When using the Java Agent, you donâ€™t need the full SDKâ€”just the annotations library. The agent provides the runtime.</p>
</blockquote>

<h2 id="method-1-withspan-annotation-easiest">Method 1: @WithSpan Annotation (Easiest)</h2>

<p>The simplest way to add custom spans is with the <code class="language-plaintext highlighter-rouge">@WithSpan</code> annotation:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">io.opentelemetry.instrumentation.annotations.WithSpan</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.opentelemetry.instrumentation.annotations.SpanAttribute</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
    
    <span class="nd">@WithSpan</span><span class="o">(</span><span class="s">"process-order"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">processOrder</span><span class="o">(</span>
            <span class="nd">@SpanAttribute</span><span class="o">(</span><span class="s">"order.customer_id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">customerId</span><span class="o">,</span>
            <span class="nd">@SpanAttribute</span><span class="o">(</span><span class="s">"order.amount"</span><span class="o">)</span> <span class="nc">BigDecimal</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        
        <span class="n">validateOrder</span><span class="o">(</span><span class="n">customerId</span><span class="o">,</span> <span class="n">amount</span><span class="o">);</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">createOrder</span><span class="o">(</span><span class="n">customerId</span><span class="o">,</span> <span class="n">amount</span><span class="o">);</span>
        <span class="n">sendConfirmation</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
        
        <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@WithSpan</span><span class="o">(</span><span class="s">"validate-order"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateOrder</span><span class="o">(</span><span class="nc">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="nc">BigDecimal</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Validation logic</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">amount</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ZERO</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidOrderException</span><span class="o">(</span><span class="s">"Amount must be positive"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now your trace shows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /orders
â””â”€â”€ process-order [customer_id: "cust-123", amount: 99.99]
    â””â”€â”€ validate-order
</code></pre></div></div>

<h2 id="method-2-programmatic-spans-full-control">Method 2: Programmatic Spans (Full Control)</h2>

<p>For more control, create spans programmatically:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">io.opentelemetry.api.GlobalOpenTelemetry</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.opentelemetry.api.trace.Span</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.opentelemetry.api.trace.Tracer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.opentelemetry.context.Scope</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentService</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Tracer</span> <span class="n">tracer</span> <span class="o">=</span> <span class="nc">GlobalOpenTelemetry</span><span class="o">.</span><span class="na">getTracer</span><span class="o">(</span><span class="s">"payment-service"</span><span class="o">);</span>
    
    <span class="kd">public</span> <span class="nc">PaymentResult</span> <span class="nf">processPayment</span><span class="o">(</span><span class="nc">String</span> <span class="n">orderId</span><span class="o">,</span> <span class="nc">BigDecimal</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Span</span> <span class="n">span</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="na">spanBuilder</span><span class="o">(</span><span class="s">"process-payment"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">,</span> <span class="n">orderId</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"payment.amount"</span><span class="o">,</span> <span class="n">amount</span><span class="o">.</span><span class="na">doubleValue</span><span class="o">())</span>
            <span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"payment.currency"</span><span class="o">,</span> <span class="s">"USD"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">startSpan</span><span class="o">();</span>
        
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scope</span> <span class="n">scope</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="na">makeCurrent</span><span class="o">())</span> <span class="o">{</span>
            <span class="c1">// Your payment logic</span>
            <span class="nc">PaymentResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">callPaymentGateway</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>
            
            <span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"payment.transaction_id"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getTransactionId</span><span class="o">());</span>
            <span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"payment.status"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
            
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
            
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">PaymentException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">span</span><span class="o">.</span><span class="na">recordException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="n">span</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="nc">StatusCode</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
            <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
            
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">span</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="adding-events-to-spans">Adding Events to Spans</h2>

<p>Events are timestamped annotations within a spanâ€”perfect for marking checkpoints:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WithSpan</span><span class="o">(</span><span class="s">"process-order"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Order</span> <span class="nf">processOrder</span><span class="o">(</span><span class="nc">OrderRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Span</span> <span class="n">currentSpan</span> <span class="o">=</span> <span class="nc">Span</span><span class="o">.</span><span class="na">current</span><span class="o">();</span>
    
    <span class="c1">// Mark validation complete</span>
    <span class="n">currentSpan</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="s">"order.validated"</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"validation.result"</span><span class="o">),</span> <span class="s">"passed"</span>
    <span class="o">));</span>
    
    <span class="c1">// Mark inventory reserved</span>
    <span class="n">reserveInventory</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getSku</span><span class="o">());</span>
    <span class="n">currentSpan</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="s">"inventory.reserved"</span><span class="o">);</span>
    
    <span class="c1">// Mark payment processed</span>
    <span class="n">processPayment</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="n">currentSpan</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="s">"payment.processed"</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"payment.method"</span><span class="o">),</span> <span class="n">request</span><span class="o">.</span><span class="na">getPaymentMethod</span><span class="o">()</span>
    <span class="o">));</span>
    
    <span class="k">return</span> <span class="nf">createOrder</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In Jaeger, youâ€™ll see these events as markers on the span timeline.</p>

<h2 id="recording-exceptions">Recording Exceptions</h2>

<p>Always record exceptions for debugging:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
    <span class="n">riskyOperation</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Span</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">recordException</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="nc">Attributes</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="nc">AttributeKey</span><span class="o">.</span><span class="na">stringKey</span><span class="o">(</span><span class="s">"exception.context"</span><span class="o">),</span> <span class="s">"During inventory check"</span>
    <span class="o">));</span>
    <span class="nc">Span</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">setStatus</span><span class="o">(</span><span class="nc">StatusCode</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="s">"Inventory check failed"</span><span class="o">);</span>
    <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This adds the full stack trace to your span, visible in Jaeger.</p>

<h2 id="best-practices">Best Practices</h2>

<h3 id="1-use-semantic-conventions">1. Use Semantic Conventions</h3>

<p>OpenTelemetry defines standard attribute names. Use them:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Good - follows semantic conventions</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"http.request.method"</span><span class="o">,</span> <span class="s">"POST"</span><span class="o">);</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"db.system"</span><span class="o">,</span> <span class="s">"postgresql"</span><span class="o">);</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"messaging.system"</span><span class="o">,</span> <span class="s">"kafka"</span><span class="o">);</span>

<span class="c1">// Avoid - custom names that aren't standard</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"method"</span><span class="o">,</span> <span class="s">"POST"</span><span class="o">);</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"database"</span><span class="o">,</span> <span class="s">"postgresql"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="2-mind-your-span-names">2. Mind Your Span Names</h3>

<p>Span names should be <strong>low-cardinality</strong>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Good - fixed name</span>
<span class="n">tracer</span><span class="o">.</span><span class="na">spanBuilder</span><span class="o">(</span><span class="s">"get-order-by-id"</span><span class="o">)</span>

<span class="c1">// Bad - high cardinality (includes variable data)</span>
<span class="n">tracer</span><span class="o">.</span><span class="na">spanBuilder</span><span class="o">(</span><span class="s">"get-order-"</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">)</span>
</code></pre></div></div>

<p>Put variable data in <strong>attributes</strong>, not span names.</p>

<h3 id="3-dont-over-instrument">3. Donâ€™t Over-Instrument</h3>

<p>Every span has overhead. Focus on:</p>
<ul>
  <li>Business operations (not every helper method)</li>
  <li>External calls (APIs, databases)</li>
  <li>Long-running processes</li>
  <li>Error-prone code paths</li>
</ul>

<h3 id="4-add-context-not-noise">4. Add Context, Not Noise</h3>

<p>Good attributes help debugging:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">,</span> <span class="n">orderId</span><span class="o">);</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"order.item_count"</span><span class="o">,</span> <span class="n">items</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"customer.tier"</span><span class="o">,</span> <span class="n">customer</span><span class="o">.</span><span class="na">getTier</span><span class="o">());</span>
</code></pre></div></div>

<p>Avoid sensitive data (PII, passwords, tokens).</p>

<h2 id="complete-example-order-processing">Complete Example: Order Processing</h2>

<p>Hereâ€™s a realistic example combining all techniques:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Tracer</span> <span class="n">tracer</span> <span class="o">=</span> <span class="nc">GlobalOpenTelemetry</span><span class="o">.</span><span class="na">getTracer</span><span class="o">(</span><span class="s">"order-service"</span><span class="o">);</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">InventoryClient</span> <span class="n">inventoryClient</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PaymentClient</span> <span class="n">paymentClient</span><span class="o">;</span>
    
    <span class="nd">@WithSpan</span><span class="o">(</span><span class="s">"create-order"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">createOrder</span><span class="o">(</span>
            <span class="nd">@SpanAttribute</span><span class="o">(</span><span class="s">"order.customer_id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">customerId</span><span class="o">,</span>
            <span class="nd">@SpanAttribute</span><span class="o">(</span><span class="s">"order.sku"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">sku</span><span class="o">,</span>
            <span class="nd">@SpanAttribute</span><span class="o">(</span><span class="s">"order.quantity"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
        
        <span class="nc">Span</span> <span class="n">span</span> <span class="o">=</span> <span class="nc">Span</span><span class="o">.</span><span class="na">current</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
        <span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">,</span> <span class="n">orderId</span><span class="o">);</span>
        
        <span class="c1">// Check inventory</span>
        <span class="n">checkInventory</span><span class="o">(</span><span class="n">sku</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
        <span class="n">span</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="s">"inventory.checked"</span><span class="o">);</span>
        
        <span class="c1">// Calculate pricing</span>
        <span class="nc">BigDecimal</span> <span class="n">total</span> <span class="o">=</span> <span class="n">calculateTotal</span><span class="o">(</span><span class="n">sku</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
        <span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"order.total"</span><span class="o">,</span> <span class="n">total</span><span class="o">.</span><span class="na">doubleValue</span><span class="o">());</span>
        
        <span class="c1">// Process payment</span>
        <span class="nc">String</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="n">processPayment</span><span class="o">(</span><span class="n">customerId</span><span class="o">,</span> <span class="n">total</span><span class="o">);</span>
        <span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"payment.id"</span><span class="o">,</span> <span class="n">paymentId</span><span class="o">);</span>
        <span class="n">span</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="s">"payment.completed"</span><span class="o">);</span>
        
        <span class="c1">// Save order</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">saveOrder</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">sku</span><span class="o">,</span> <span class="n">quantity</span><span class="o">,</span> <span class="n">total</span><span class="o">);</span>
        <span class="n">span</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="s">"order.saved"</span><span class="o">);</span>
        
        <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">checkInventory</span><span class="o">(</span><span class="nc">String</span> <span class="n">sku</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Span</span> <span class="n">span</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="na">spanBuilder</span><span class="o">(</span><span class="s">"check-inventory"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"inventory.sku"</span><span class="o">,</span> <span class="n">sku</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"inventory.quantity_requested"</span><span class="o">,</span> <span class="n">quantity</span><span class="o">)</span>
            <span class="o">.</span><span class="na">startSpan</span><span class="o">();</span>
        
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scope</span> <span class="n">scope</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="na">makeCurrent</span><span class="o">())</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">available</span> <span class="o">=</span> <span class="n">inventoryClient</span><span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">sku</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
            <span class="n">span</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"inventory.available"</span><span class="o">,</span> <span class="n">available</span><span class="o">);</span>
            
            <span class="k">if</span> <span class="o">(!</span><span class="n">available</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">InsufficientInventoryException</span><span class="o">(</span><span class="n">sku</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">span</span><span class="o">.</span><span class="na">recordException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="n">span</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="nc">StatusCode</span><span class="o">.</span><span class="na">ERROR</span><span class="o">);</span>
            <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">span</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="whats-next">Whatâ€™s Next</h2>

<p>You now have rich, contextual traces. But observability is more than tracing.</p>

<p>In <strong>Part 4</strong>, weâ€™ll add <strong>custom metrics</strong>:</p>
<ul>
  <li>Request counters</li>
  <li>Latency histograms</li>
  <li>Business gauges (orders per minute, active users)</li>
</ul>

<p>Weâ€™ll export to Prometheus and build dashboards in Grafana.</p>

<hr />

<p><em>Previous: <a href="/2026/01/09/opentelemetry-java-part-2-zero-to-tracing/">Part 2 - Zero to Tracing</a></em></p>

<p><em>Next: <a href="/2026/01/11/opentelemetry-java-part-4-metrics/">Part 4 - Metrics That Matter</a></em></p>

<hr />

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://opentelemetry.io/docs/languages/java/automatic/annotations/">OTel Instrumentation Annotations</a></li>
  <li><a href="https://opentelemetry.io/docs/concepts/semantic-conventions/">Semantic Conventions</a></li>
  <li><a href="https://opentelemetry.io/docs/languages/java/api/">Span API Reference</a></li>
</ul>]]></content><author><name>Laxman Sharma</name></author><category term="observability" /><category term="java" /><category term="opentelemetry" /><category term="manual-instrumentation" /><category term="spring-boot" /><category term="annotations" /><summary type="html"><![CDATA[Enrich your auto-instrumentation with custom spans, business attributes, and events. Learn when and how to add manual instrumentation for better debugging.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/otel-part3-hero.png" /><media:content medium="image" url="http://localhost:4000/assets/images/otel-part3-hero.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">OpenTelemetry with Java: Part 2 - Zero to Tracing in 15 Minutes</title><link href="http://localhost:4000/2026/01/09/opentelemetry-java-part-2-zero-to-tracing/" rel="alternate" type="text/html" title="OpenTelemetry with Java: Part 2 - Zero to Tracing in 15 Minutes" /><published>2026-01-09T00:00:00+08:00</published><updated>2026-01-09T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/09/opentelemetry-java-part-2-zero-to-tracing</id><content type="html" xml:base="http://localhost:4000/2026/01/09/opentelemetry-java-part-2-zero-to-tracing/"><![CDATA[<h1 id="zero-to-tracing-in-15-minutes">Zero to Tracing in 15 Minutes</h1>

<p><em>Part 2 of a 6-part series on implementing observability in Java microservices</em></p>

<hr />

<p>In <a href="/2026/01/08/opentelemetry-java-part-1-fundamentals/">Part 1</a>, we built the mental model for OpenTelemetry. Now itâ€™s time to get our hands dirty.</p>

<p>By the end of this article, youâ€™ll have <strong>distributed tracing working across multiple microservices</strong> with zero code changes. Weâ€™ll use the OpenTelemetry Java Agent for auto-instrumentation and Jaeger for visualization.</p>

<h2 id="what-were-building">What Weâ€™re Building</h2>

<p>Weâ€™ll set up a simple e-commerce flow:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User â†’ Order Service â†’ Inventory Service â†’ Payment Service
</code></pre></div></div>

<p>Each service will automatically create spans, and weâ€™ll see the complete trace in Jaeger.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>Java 17+</li>
  <li>Docker &amp; Docker Compose</li>
  <li>Maven or Gradle</li>
  <li>15 minutes â˜•</li>
</ul>

<h2 id="step-1-set-up-jaeger-with-docker">Step 1: Set Up Jaeger with Docker</h2>

<p>First, letâ€™s get Jaeger running locally. Create a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">jaeger</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">jaegertracing/all-in-one:1.53</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">jaeger</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">16686:16686"</span>   <span class="c1"># Jaeger UI</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">4317:4317"</span>     <span class="c1"># OTLP gRPC</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">4318:4318"</span>     <span class="c1"># OTLP HTTP</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">COLLECTOR_OTLP_ENABLED=true</span>
</code></pre></div></div>

<p>Start it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose up <span class="nt">-d</span>
</code></pre></div></div>

<p>Open http://localhost:16686 â€” you should see the Jaeger UI.</p>

<h2 id="step-2-download-the-opentelemetry-java-agent">Step 2: Download the OpenTelemetry Java Agent</h2>

<p>The OTel Java Agent automatically instruments your application without code changes.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Download the latest agent</span>
curl <span class="nt">-L</span> <span class="nt">-o</span> opentelemetry-javaagent.jar <span class="se">\</span>
  https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/latest/download/opentelemetry-javaagent.jar
</code></pre></div></div>

<p>Place it in your project root or a shared location.</p>

<h2 id="step-3-create-the-demo-services">Step 3: Create the Demo Services</h2>

<p>For this demo, weâ€™ll create three simple Spring Boot services. Hereâ€™s the Order Service:</p>

<h3 id="order-service-port-8080">Order Service (port 8080)</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/orders"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">RestTemplate</span> <span class="n">restTemplate</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">OrderController</span><span class="o">(</span><span class="nc">RestTemplateBuilder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">restTemplate</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="nf">createOrder</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">OrderRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Check inventory</span>
        <span class="nc">Boolean</span> <span class="n">available</span> <span class="o">=</span> <span class="n">restTemplate</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span>
            <span class="s">"http://localhost:8081/inventory/check?sku="</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="na">getSku</span><span class="o">(),</span>
            <span class="nc">Boolean</span><span class="o">.</span><span class="na">class</span>
        <span class="o">);</span>
        
        <span class="k">if</span> <span class="o">(!</span><span class="n">available</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">badRequest</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
        <span class="o">}</span>
        
        <span class="c1">// Process payment</span>
        <span class="nc">PaymentResult</span> <span class="n">payment</span> <span class="o">=</span> <span class="n">restTemplate</span><span class="o">.</span><span class="na">postForObject</span><span class="o">(</span>
            <span class="s">"http://localhost:8082/payments"</span><span class="o">,</span>
            <span class="k">new</span> <span class="nf">PaymentRequest</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getAmount</span><span class="o">()),</span>
            <span class="nc">PaymentResult</span><span class="o">.</span><span class="na">class</span>
        <span class="o">);</span>
        
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="s">"CONFIRMED"</span><span class="o">);</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="inventory-service-port-8081">Inventory Service (port 8081)</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/inventory"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InventoryController</span> <span class="o">{</span>
    
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/check"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Boolean</span> <span class="nf">checkInventory</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="nc">String</span> <span class="n">sku</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Simulate DB lookup</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span> <span class="c1">// Simulate latency</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">interrupt</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="payment-service-port-8082">Payment Service (port 8082)</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/payments"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
    
    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="nc">PaymentResult</span> <span class="nf">processPayment</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">PaymentRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Simulate payment processing</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span> <span class="c1">// Simulate external API call</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">interrupt</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PaymentResult</span><span class="o">(</span><span class="s">"SUCCESS"</span><span class="o">,</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="step-4-run-with-the-otel-agent">Step 4: Run with the OTel Agent</h2>

<p>Now the magic happens. Run each service with the Java Agent attached:</p>

<h3 id="order-service">Order Service</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="se">\</span>
  <span class="nt">-Dotel</span>.service.name<span class="o">=</span>order-service <span class="se">\</span>
  <span class="nt">-Dotel</span>.exporter.otlp.endpoint<span class="o">=</span>http://localhost:4317 <span class="se">\</span>
  <span class="nt">-Dotel</span>.traces.exporter<span class="o">=</span>otlp <span class="se">\</span>
  <span class="nt">-jar</span> order-service/target/order-service.jar
</code></pre></div></div>

<h3 id="inventory-service">Inventory Service</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="se">\</span>
  <span class="nt">-Dotel</span>.service.name<span class="o">=</span>inventory-service <span class="se">\</span>
  <span class="nt">-Dotel</span>.exporter.otlp.endpoint<span class="o">=</span>http://localhost:4317 <span class="se">\</span>
  <span class="nt">-Dotel</span>.traces.exporter<span class="o">=</span>otlp <span class="se">\</span>
  <span class="nt">-jar</span> inventory-service/target/inventory-service.jar
</code></pre></div></div>

<h3 id="payment-service">Payment Service</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="se">\</span>
  <span class="nt">-Dotel</span>.service.name<span class="o">=</span>payment-service <span class="se">\</span>
  <span class="nt">-Dotel</span>.exporter.otlp.endpoint<span class="o">=</span>http://localhost:4317 <span class="se">\</span>
  <span class="nt">-Dotel</span>.traces.exporter<span class="o">=</span>otlp <span class="se">\</span>
  <span class="nt">-jar</span> payment-service/target/payment-service.jar
</code></pre></div></div>

<h2 id="step-5-make-a-request-and-view-the-trace">Step 5: Make a Request and View the Trace</h2>

<p>Send a test request:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST http://localhost:8080/orders <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"sku": "LAPTOP-001", "amount": 999.99}'</span>
</code></pre></div></div>

<p>Now open <strong>Jaeger UI</strong> at http://localhost:16686:</p>

<ol>
  <li>Select <strong>order-service</strong> from the Service dropdown</li>
  <li>Click <strong>Find Traces</strong></li>
  <li>Click on the trace to see the full timeline</li>
</ol>

<p>You should see a beautiful waterfall visualization showing:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">POST /orders</code> (order-service)
    <ul>
      <li><code class="language-plaintext highlighter-rouge">GET /inventory/check</code> (inventory-service)</li>
      <li><code class="language-plaintext highlighter-rouge">POST /payments</code> (payment-service)</li>
    </ul>
  </li>
</ul>

<h2 id="what-the-agent-instruments-automatically">What the Agent Instruments Automatically</h2>

<p>The OTel Java Agent provides out-of-the-box instrumentation for:</p>

<table>
  <thead>
    <tr>
      <th>Library/Framework</th>
      <th>Whatâ€™s Traced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Spring MVC</td>
      <td>Incoming HTTP requests</td>
    </tr>
    <tr>
      <td>RestTemplate/WebClient</td>
      <td>Outgoing HTTP calls</td>
    </tr>
    <tr>
      <td>JDBC</td>
      <td>Database queries</td>
    </tr>
    <tr>
      <td>Kafka</td>
      <td>Producer/Consumer operations</td>
    </tr>
    <tr>
      <td>gRPC</td>
      <td>Client and server calls</td>
    </tr>
    <tr>
      <td>Redis</td>
      <td>Cache operations</td>
    </tr>
    <tr>
      <td>100+ moreâ€¦</td>
      <td><a href="https://opentelemetry.io/docs/languages/java/automatic/libraries/">Full list</a></td>
    </tr>
  </tbody>
</table>

<h2 id="key-configuration-options">Key Configuration Options</h2>

<table>
  <thead>
    <tr>
      <th>Environment Variable</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">OTEL_SERVICE_NAME</code></td>
      <td>Your service name (required)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">OTEL_EXPORTER_OTLP_ENDPOINT</code></td>
      <td>Where to send traces</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">OTEL_TRACES_EXPORTER</code></td>
      <td><code class="language-plaintext highlighter-rouge">otlp</code>, <code class="language-plaintext highlighter-rouge">jaeger</code>, <code class="language-plaintext highlighter-rouge">zipkin</code>, <code class="language-plaintext highlighter-rouge">none</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">OTEL_TRACES_SAMPLER</code></td>
      <td><code class="language-plaintext highlighter-rouge">always_on</code>, <code class="language-plaintext highlighter-rouge">always_off</code>, <code class="language-plaintext highlighter-rouge">parentbased_traceidratio</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">OTEL_TRACES_SAMPLER_ARG</code></td>
      <td>Sampling ratio (0.0 to 1.0)</td>
    </tr>
  </tbody>
</table>

<h2 id="using-environment-variables-recommended">Using Environment Variables (Recommended)</h2>

<p>Instead of JVM args, use environment variables for cleaner configuration:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OTEL_SERVICE_NAME</span><span class="o">=</span>order-service
<span class="nb">export </span><span class="nv">OTEL_EXPORTER_OTLP_ENDPOINT</span><span class="o">=</span>http://localhost:4317
<span class="nb">export </span><span class="nv">OTEL_TRACES_EXPORTER</span><span class="o">=</span>otlp

java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="nt">-jar</span> order-service.jar
</code></pre></div></div>

<h2 id="troubleshooting">Troubleshooting</h2>

<p><strong>No traces appearing?</strong></p>
<ol>
  <li>Check Jaeger is running: <code class="language-plaintext highlighter-rouge">docker ps</code></li>
  <li>Ensure OTLP endpoint is correct (port 4317 for gRPC)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">-Dotel.javaagent.debug=true</code> for verbose logging</li>
</ol>

<p><strong>Missing spans for a library?</strong>
Check if itâ€™s in the <a href="https://opentelemetry.io/docs/languages/java/automatic/libraries/">supported libraries list</a>.</p>

<h2 id="whats-next">Whatâ€™s Next</h2>

<p>Now you have distributed tracing with <strong>zero code changes</strong>. But the auto-generated spans are generic. In <strong>Part 3</strong>, weâ€™ll add:</p>

<ul>
  <li>Custom spans for business operations</li>
  <li>Business attributes (<code class="language-plaintext highlighter-rouge">orderId</code>, <code class="language-plaintext highlighter-rouge">customerId</code>)</li>
  <li>Exception recording and events</li>
</ul>

<p>The traces will become much more useful for debugging real production issues.</p>

<hr />

<p><em>Previous: <a href="/2026/01/08/opentelemetry-java-part-1-fundamentals/">Part 1 - Understanding the Fundamentals</a></em></p>

<p><em>Next: <a href="/2026/01/10/opentelemetry-java-part-3-custom-instrumentation/">Part 3 - Adding Custom Instrumentation</a></em></p>

<hr />

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://opentelemetry.io/docs/languages/java/automatic/">OpenTelemetry Java Agent Docs</a></li>
  <li><a href="https://www.jaegertracing.io/docs/">Jaeger Documentation</a></li>
  <li><a href="https://opentelemetry.io/docs/languages/java/automatic/configuration/">Agent Configuration Reference</a></li>
</ul>]]></content><author><name>Laxman Sharma</name></author><category term="observability" /><category term="java" /><category term="opentelemetry" /><category term="distributed-tracing" /><category term="java-agent" /><category term="jaeger" /><category term="docker" /><summary type="html"><![CDATA[Get distributed tracing working in your Java microservices with zero code changes. We'll use the OpenTelemetry Java Agent and Jaeger to see traces in action.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/otel-part2-hero.png" /><media:content medium="image" url="http://localhost:4000/assets/images/otel-part2-hero.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">OpenTelemetry with Java: Part 1 - Understanding the Fundamentals</title><link href="http://localhost:4000/2026/01/08/opentelemetry-java-part-1-fundamentals/" rel="alternate" type="text/html" title="OpenTelemetry with Java: Part 1 - Understanding the Fundamentals" /><published>2026-01-08T00:00:00+08:00</published><updated>2026-01-08T00:00:00+08:00</updated><id>http://localhost:4000/2026/01/08/opentelemetry-java-part-1-fundamentals</id><content type="html" xml:base="http://localhost:4000/2026/01/08/opentelemetry-java-part-1-fundamentals/"><![CDATA[<h1 id="opentelemetry-with-java-understanding-the-fundamentals">OpenTelemetry with Java: Understanding the Fundamentals</h1>

<p><em>Part 1 of a 6-part series on implementing observability in Java microservices</em></p>

<hr />

<p>If youâ€™ve ever stared at logs from 10 different microservices trying to figure out why a userâ€™s request failed, you know the pain. The request worked in dev, passed staging, but something went wrong in productionâ€”and you have no idea which service is to blame.</p>

<p>This is the problem observability solves. And OpenTelemetry (OTel) is now the industry standard for implementing it.</p>

<p>In this series, weâ€™ll build production-ready observability into a Java microservices system. But before we write any code, letâ€™s build the mental model.</p>

<h2 id="what-is-observability">What is Observability?</h2>

<p>Observability is your ability to understand whatâ€™s happening inside your system by examining its outputs. Unlike traditional monitoring (which tells you <em>that</em> something is wrong), observability helps you understand <em>why</em>.</p>

<p>The three pillars of observability are:</p>

<h3 id="1-traces">1. Traces</h3>
<p>A <strong>trace</strong> represents the journey of a single request through your distributed system. Itâ€™s like a timeline showing every service the request touched, how long each step took, and what happened at each point.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User Request â†’ API Gateway â†’ Order Service â†’ Inventory Service â†’ Payment Service
     |            5ms            12ms             8ms              45ms
</code></pre></div></div>

<p>Each step in this journey is called a <strong>span</strong>. Spans have:</p>
<ul>
  <li>A name (e.g., <code class="language-plaintext highlighter-rouge">POST /orders</code>)</li>
  <li>A duration (start time â†’ end time)</li>
  <li>Attributes (metadata like <code class="language-plaintext highlighter-rouge">order.id</code>, <code class="language-plaintext highlighter-rouge">customer.id</code>)</li>
  <li>A parent-child relationship (creating the tree structure)</li>
</ul>

<h3 id="2-metrics">2. Metrics</h3>
<p><strong>Metrics</strong> are numerical measurements collected over time:</p>
<ul>
  <li>Request counts</li>
  <li>Error rates</li>
  <li>Response time percentiles (p50, p95, p99)</li>
  <li>Active connections</li>
  <li>Queue depths</li>
</ul>

<p>Metrics answer questions like: â€œHow many requests per second are we handling?â€ or â€œWhat percentage of requests are failing?â€</p>

<h3 id="3-logs">3. Logs</h3>
<p><strong>Logs</strong> are timestamped records of discrete events:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2026-01-08T10:15:30Z [INFO] Order created: orderId=12345, customerId=abc
2026-01-08T10:15:31Z [ERROR] Payment failed: orderId=12345, reason=insufficient_funds
</code></pre></div></div>

<p>The power comes when you <strong>correlate</strong> all three: find the error in logs, jump to the trace to see the full request flow, then check metrics to see if this is an isolated incident or a pattern.</p>

<h2 id="why-opentelemetry">Why OpenTelemetry?</h2>

<p>Before OpenTelemetry, the observability landscape was fragmented:</p>
<ul>
  <li><strong>OpenTracing</strong> for distributed tracing</li>
  <li><strong>OpenCensus</strong> for metrics and tracing</li>
  <li>Vendor-specific SDKs (Datadog, New Relic, Jaeger, etc.)</li>
</ul>

<p>OpenTelemetry emerged as the <strong>merger of OpenTracing and OpenCensus</strong>, and is now a CNCF project (same foundation as Kubernetes). It provides:</p>

<table>
  <thead>
    <tr>
      <th>Benefit</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Vendor-neutral</strong></td>
      <td>Instrument once, export to any backend</td>
    </tr>
    <tr>
      <td><strong>Standardized</strong></td>
      <td>Consistent APIs across languages</td>
    </tr>
    <tr>
      <td><strong>Full coverage</strong></td>
      <td>Traces, metrics, AND logs</td>
    </tr>
    <tr>
      <td><strong>Auto-instrumentation</strong></td>
      <td>Works with zero code changes</td>
    </tr>
  </tbody>
</table>

<h2 id="opentelemetry-architecture">OpenTelemetry Architecture</h2>

<p>Understanding OTelâ€™s components is crucial before implementation:</p>

<p><img src="/assets/images/otel-architecture.png" alt="OpenTelemetry Architecture - Java SDK to Collector to Backends" /></p>

<p><em>The flow: Your Java application with OTel SDK/Agent sends telemetry via OTLP to the Collector, which routes it to backends like Jaeger, Prometheus, or any vendor.</em></p>

<h3 id="the-components">The Components</h3>

<p><strong>API</strong>: Interfaces for instrumentation. Lightweight, safe to use everywhere.</p>

<p><strong>SDK</strong>: Implementation of the API. Configures how telemetry is processed and exported.</p>

<p><strong>Java Agent</strong>: Attaches to your JVM and automatically instruments common librariesâ€”HTTP clients, database drivers, messaging systemsâ€”with zero code changes.</p>

<p><strong>Collector</strong>: A standalone service that receives, processes, and exports telemetry. Acts as a central hub for your observability pipeline.</p>

<p><strong>Exporters</strong>: Send telemetry to backends (Jaeger, Prometheus, Datadog, etc.)</p>

<h2 id="key-concepts-deep-dive">Key Concepts Deep Dive</h2>

<h3 id="context-propagation">Context Propagation</h3>

<p>When Service A calls Service B, how does Service B know itâ€™s part of the same trace?</p>

<p><strong>Context propagation</strong> is the mechanism that passes trace context (trace ID, span ID) between services. OpenTelemetry uses HTTP headers (specifically W3C Trace Context):</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/inventory/check</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">inventory-service</span>
<span class="na">traceparent</span><span class="p">:</span> <span class="s">00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">traceparent</code> header carries the trace ID and parent span ID, allowing the receiving service to continue the same trace.</p>

<h3 id="semantic-conventions">Semantic Conventions</h3>

<p>OpenTelemetry defines <strong>semantic conventions</strong>â€”standardized names for common attributes:</p>

<table>
  <thead>
    <tr>
      <th>Convention</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">http.request.method</code></td>
      <td><code class="language-plaintext highlighter-rouge">GET</code>, <code class="language-plaintext highlighter-rouge">POST</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">http.response.status_code</code></td>
      <td><code class="language-plaintext highlighter-rouge">200</code>, <code class="language-plaintext highlighter-rouge">500</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">db.system</code></td>
      <td><code class="language-plaintext highlighter-rouge">postgresql</code>, <code class="language-plaintext highlighter-rouge">mysql</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">service.name</code></td>
      <td><code class="language-plaintext highlighter-rouge">order-service</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">deployment.environment</code></td>
      <td><code class="language-plaintext highlighter-rouge">production</code></td>
    </tr>
  </tbody>
</table>

<p>Using these conventions means your telemetry works consistently with dashboards and tools across the ecosystem.</p>

<h3 id="resources">Resources</h3>

<p>A <strong>resource</strong> identifies the entity producing telemetry:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">service.name</span><span class="pi">:</span> <span class="s">order-service</span>
<span class="na">service.version</span><span class="pi">:</span> <span class="s">1.2.3</span>
<span class="na">deployment.environment</span><span class="pi">:</span> <span class="s">production</span>
<span class="na">host.name</span><span class="pi">:</span> <span class="s">pod-xyz-123</span>
</code></pre></div></div>

<p>Resources are attached to all telemetry, enabling filtering like â€œshow me all traces from order-service in production.â€</p>

<h2 id="auto-vs-manual-instrumentation">Auto vs Manual Instrumentation</h2>

<p>OpenTelemetry offers two instrumentation approaches:</p>

<h3 id="auto-instrumentation-zero-code">Auto-Instrumentation (Zero-Code)</h3>

<p>Attach the Java agent to your JVM:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-javaagent</span>:opentelemetry-javaagent.jar <span class="nt">-jar</span> myapp.jar
</code></pre></div></div>

<p><strong>What you get automatically:</strong></p>
<ul>
  <li>HTTP server/client spans (Spring MVC, Servlet, RestTemplate, WebClient)</li>
  <li>Database spans (JDBC, Hibernate)</li>
  <li>Messaging spans (Kafka, RabbitMQ)</li>
  <li>gRPC spans</li>
  <li>And 100+ other libraries</li>
</ul>

<p><strong>Pros</strong>: Fast rollout, no code changes, consistent across services<br />
<strong>Cons</strong>: Less control over span names and attributes</p>

<h3 id="manual-instrumentation">Manual Instrumentation</h3>

<p>Add custom spans and attributes for business context:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WithSpan</span><span class="o">(</span><span class="s">"process-payment"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">PaymentResult</span> <span class="nf">processPayment</span><span class="o">(</span>
    <span class="nd">@SpanAttribute</span><span class="o">(</span><span class="s">"order.id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">orderId</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Your business logic</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Pros</strong>: Full control, business-relevant context<br />
<strong>Cons</strong>: Requires code changes, more maintenance</p>

<p><strong>Best practice</strong>: Start with auto-instrumentation, then add manual instrumentation where you need business context.</p>

<h2 id="whats-next">Whatâ€™s Next</h2>

<p>Now you have the mental model. In <strong>Part 2</strong>, weâ€™ll get hands-on:</p>

<ul>
  <li>Set up a 3-service demo project</li>
  <li>Configure the OpenTelemetry Java Agent</li>
  <li>Run Jaeger locally with Docker</li>
  <li>See your first distributed trace</li>
</ul>

<p>No more theoryâ€”just code.</p>

<hr />

<p><em>Next: <a href="/2026/01/09/opentelemetry-java-part-2-zero-to-tracing/">Part 2 - Zero to Tracing in 15 Minutes</a></em></p>

<hr />

<h2 id="resources-1">Resources</h2>

<ul>
  <li><a href="https://opentelemetry.io/docs/">OpenTelemetry Documentation</a></li>
  <li><a href="https://opentelemetry.io/docs/languages/java/">OpenTelemetry Java</a></li>
  <li><a href="https://opentelemetry.io/docs/concepts/semantic-conventions/">Semantic Conventions</a></li>
  <li><a href="https://www.cncf.io/projects/opentelemetry/">CNCF OpenTelemetry Project</a></li>
</ul>]]></content><author><name>Laxman Sharma</name></author><category term="observability" /><category term="java" /><category term="opentelemetry" /><category term="distributed-tracing" /><category term="microservices" /><category term="java" /><category term="spring-boot" /><summary type="html"><![CDATA[A comprehensive introduction to OpenTelemetry concepts for Java developers. Learn about traces, metrics, logs, and how they work together in distributed microservices.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/otel-hero-banner.png" /><media:content medium="image" url="http://localhost:4000/assets/images/otel-hero-banner.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>